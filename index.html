<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MaestroBOT - Web Edition</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <button class="toggle-sidebar" id="toggle-sidebar">â˜° Instructions</button>
    
    <div class="layout">
        <aside class="sidebar hidden" id="sidebar">
            <div class="instructions">
                <h3>Control Modes</h3>
                
                <div class="instruction-section">
                    <h4>Slider Controls (Hands work independently):</h4>
                    <ul>
                        <li><strong>Playback (Left Hand):</strong></li>
                        <li>â€¢ Open Hand â†’ Play/Resume</li>
                        <li>â€¢ Closed Fist â†’ Fade to Pause</li>
                        <li style="margin-top: 10px;"><strong>Sliders (Right Hand):</strong></li>
                        <li>â€¢ Open Hand + Move L/R â†’ Speed<br>
                            <span class="sub-instruction">(Right=Faster, Left=Slower)</span>
                        </li>
                        <li>â€¢ Closed Fist + Move U/D â†’ Volume<br>
                            <span class="sub-instruction">(Up=Louder, Down=Quieter)</span>
                        </li>
                    </ul>
                </div>

                <div class="instruction-section">
                    <h4>Static Gestures (Hands work together):</h4>
                    <ul>
                        <li><strong>Playback:</strong></li>
                        <li>â€¢ Both Hands Open â†’ Play/Resume</li>
                        <li>â€¢ Both Hands Closed â†’ Fade to Pause</li>
                        <li style="margin-top: 10px;"><strong>Volume (Left Hand):</strong></li>
                        <li>â€¢ 1 Finger â†’ 25%</li>
                        <li>â€¢ 2 Fingers â†’ 50%</li>
                        <li>â€¢ 3 Fingers â†’ 75%</li>
                        <li>â€¢ 4 Fingers â†’ 100%</li>
                        <li style="margin-top: 10px;"><strong>Speed (Right Hand):</strong></li>
                        <li>â€¢ 1 Finger â†’ 0.50x</li>
                        <li>â€¢ 2 Fingers â†’ 0.75x</li>
                        <li>â€¢ 3 Fingers â†’ 1.00x</li>
                        <li>â€¢ 4 Fingers â†’ 1.50x</li>
                    </ul>
                </div>
            </div>
        </aside>

        <main class="main-content">
            <header>
                <h1>ðŸŽµ MaestroBOT</h1>
                <p class="subtitle">Control music with hand gestures</p>
            </header>

            <div class="video-container">
                <video id="video" autoplay playsinline></video>
                <canvas id="canvas"></canvas>
                <div id="video-overlay">Camera Off</div>
            </div>

            <div class="camera-controls">
                <button id="camera-btn" class="camera-toggle">Start Camera</button>
            </div>

            <div class="status-panel">
                <div class="status-item">
                    <label>File:</label>
                    <span id="file-status">(none)</span>
                </div>
                <div class="status-item action-status">
                    <label>Action:</label>
                    <span id="action-status">(waiting)</span>
                </div>
                <div class="status-item state-status">
                    <span id="state-status" class="state-stopped">State: stopped | Volume: 60 | Rate: 1.00x</span>
                </div>
            </div>

            <audio id="audio" preload="auto"></audio>

            <div class="controls">
                <button id="load-btn" class="control-btn">Load MP3</button>
                <button id="play-btn" class="control-btn">Play</button>
                <button id="pause-btn" class="control-btn">Pause</button>
                <button id="stop-btn" class="control-btn">Stop</button>
            </div>

            <div class="tabs">
                <button class="tab-btn active" data-tab="slider">Slider Controls</button>
                <button class="tab-btn" data-tab="static">Static Gestures</button>
            </div>

            <div class="tab-content">
                <div id="slider-tab" class="tab-pane active">
                    <p style="text-align: center; color: #B0B0B0;">Use left hand for play/pause, right hand for dynamic speed/volume control</p>
                </div>
                <div id="static-tab" class="tab-pane">
                    <p style="text-align: center; color: #B0B0B0;">Use finger counts to set specific volume and speed levels</p>
                </div>
            </div>

            <input type="file" id="file-input" accept="audio/mp3,audio/mpeg" style="display: none;">
        </main>
    </div>

    <!-- Load MediaPipe -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    
    <!-- Load Application Scripts -->
    <script src="hand-tracker.js"></script>
    <script src="app.js"></script>
</body>
</html>